    <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> RavenDB at a Glance Part 2 &middot; M. Fahrizal Rahman </title>
    
    <link rel="stylesheet" type="text/css" href="https://riesal.github.io/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="https://riesal.github.io/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="M. Fahrizal Rahman" />
    
    <script src="https://riesal.github.io/js/jquery.min.js"></script>
    <script src="https://riesal.github.io/js/main.min.js">
    </script>
</head>

    <body>
        <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="https://riesal.github.io/" title="link to homepage for M. Fahrizal Rahman"> <img src="https://eastlondonnews.co.uk/wp-content/uploads/2014/04/write-your-own-blog.jpg" width="80" alt="M. Fahrizal Rahman logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="https://riesal.github.io/"  title="link to homepage for M. Fahrizal Rahman">M. Fahrizal Rahman</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  Passionate Reader / Intispace.com  </p>
                <hr class="panel-cover__divider panel-cover__divider--secondary" />
                <div class="navigation-wrapper">
                    <nav class="cover-navigation cover-navigation--primary">
                        <ul class="navigation">
                            <li class="navigation__item"><a href="https://riesal.github.io#blog" title="link to M. Fahrizal Rahman blog" class="blog-button">View Posts</a> </li></br>
			    <li class="navigation__item"><a href="/post/" title="link to M. Fahrizal Rahman archive" class="blog-button">Archive</a> </li></br>
                            
                       </ul>
                    </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/siriesal" title="@siriesal on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="https://bitbucket.org/riesal" title="riesal on bitbucket"> <i class='fa fa-bitbucket'></i> <span class="label">Bitbucket</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="https://github.com/riesal" title="riesal on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br> 
        
        <li class="navigation__item">
            <a href="http://www.flickr.com/photos/riesal/" title="riesal on flickr"> <i class='fa fa-flickr'></i> <span class="label">Flickr</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/riesal" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:ask@intispace.com" title="Email ask@intispace.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="https://riesal.github.io/" title="link to homepage for M. Fahrizal Rahman"> <img src="https://eastlondonnews.co.uk/wp-content/uploads/2014/04/write-your-own-blog.jpg" width="80" alt="M. Fahrizal Rahman logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="https://riesal.github.io/"  title="link to homepage for M. Fahrizal Rahman">M. Fahrizal Rahman</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  Passionate Reader / Intispace.com  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                                <li class="navigation__item"><a href="https://riesal.github.io/#blog" title="link to M. Fahrizal Rahman blog" class="blog-button">Blog</a> </li></br>
                                <li class="navigation__item"><a href="/pages/cv" title="link to my CV " class="blog-button">CV</a> </li></br> 
				
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/siriesal" title="@siriesal on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="https://bitbucket.org/riesal" title="riesal on bitbucket"> <i class='fa fa-bitbucket'></i> <span class="label">Bitbucket</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="https://github.com/riesal" title="riesal on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br> 
        
        <li class="navigation__item">
            <a href="http://www.flickr.com/photos/riesal/" title="riesal on flickr"> <i class='fa fa-flickr'></i> <span class="label">Flickr</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/riesal" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:ask@intispace.com" title="Email ask@intispace.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

        <div class="content-wrapper">
            <div class="content-wrapper__inner">
                <div class="post">
                    <h1>RavenDB at a Glance Part 2</h1>
                    <span class="post-date">Mon, Sep 5, 2016</span>
                    <p>RavenDB is built to be a first-class citizen on the .NET platform offering developers the ability to easily extend and embed the database in their applications. <span id="more-4512"></span> A few of the key features that make RavenDB compelling to .NET developers are as follows:</p>

<ol>
<li>RavenDB comes with a fully functional .NET client API, which implements unit of work, change tracking, read and write optimizations, and much more. It also has a REST-based API, so you can access it via the JavaScript directly.</li>
<li>It allows developers to de ne indexes using LINQ (Language Integrated Queries). Supports map/reduce operations on top of your documents using LINQ.</li>
<li>It supports System.Transactions and can take part in distributed transactions.</li>
<li>The server can be easily extended by adding a custom .NET assembly.</li>
</ol>

<p>RavenDB architecture.</p>

<p>RavenDB leverages existing storage infrastructure called ESENT that is known
to scale to amazing sizes. ESENT is the storage engine utilized by Microsoft Exchange and Active Directory. The storage engine provides the transactional data store for the documents. RavenDB also utilizes another proven technology called Lucene.NET for its high-speed indexing engine. The following diagram shows the primary components of the RavenDB architecture:</p>

<p><img src="https://risal.files.wordpress.com/2016/09/screen-shot-2016-09-06-at-3-53-14-pm.png" alt="RavenDB architecture" title="RavenDB architecture" /></p>

<p>Storing documents.</p>

<p>When a document is inserted or updated, RavenDB performs the following:</p>

<ol>
<li>A document change comes in and is stored in ESENT. Documents are immediately available to load by ID, but won&rsquo;t appear in searches until they are indexed.</li>
<li>Asynchronous indexing task takes work from the queue and updates the Lucene index. The index can be created manually or dynamically based on the queries executed by the application.</li>
<li>The document now appears in queries. Typically, index updates have an average latency of 20 milliseconds. RavenDB provides an API to wait for updates to be indexed if needed.</li>
</ol>

<p>Searching and retrieving documents.</p>

<p>When a document request comes in, the server is able to pull them directly from the RavenDB database when a document ID is provided. All searches and other inquiries hit the Lucene index. These methods provide near instant access, regardless of the database size.</p>

<p>A key difference between RavenDB and a relational database is the way index consistency is handled. A relational database ties index updates to data modi cations. The insert, update, or delete only completes once the indexes have been updated. This provides users a consistent view of the data but can quickly degrade when the system is under heavy load.
RavenDB on the other hand uses a model for indexes known as eventual consistency. Indexes are updated asynchronously from the document storage.</p>

<p>This means that the visibility of a change within an index is not always available immediately after the document is written. By queuing the indexing operation on a background thread, the system is able to continue servicing reads while the indexing operation catches up. Eventual consistency is a bit counter-intuitive. We do not want the user to view stale data. However, in a multiuser system our users view stale data all the time. Once the data is displayed on the screen, it becomes stale and may have been modi ed by another user.</p>

<p>The following diagram illustrates stale data in a multiuser system:
<img src="https://risal.files.wordpress.com/2016/09/screen-shot-2016-09-06-at-3-58-13-pm.png" alt="&quot;multiuser system&quot;" title="multiuser system" /></p>

<p>In many cases, this staleness does not matter. Consider a blog post. When you publish a new article, does it really matter if the article becomes visible to the entire world that nanosecond? Will users on the Internet really know if it wasn&rsquo;t? What typically matters is providing feedback to the user who made the change. Either let them know when the change becomes available or pausing brie y while the indexing catches up. If a user did not initiate the data change, then it is even easier.</p>

<p>The change will simply become available when it enters the index. This provides a mechanism to give each user personal consistency. The user making the change can wait for their own changes to take affect while other users don&rsquo;t need to wait.</p>

<p>Eventual consistency is a tradeoff between application responsiveness for all users and consistency between indexes and documents. When used appropriately, this tradeoff becomes a tool for increasing the scalability of a system.</p>

                </div>
            </div>
        </div>
    </body>
    
</html>
